import React, { useState } from 'react';

const App = () => {
  const [fileContent, setFileContent] = useState('');
  const [fileName, setFileName] = useState('');

  // Function to save file
  const saveFile = async () => {
    try {
      const handle = await window.showSaveFilePicker({
        suggestedName: 'newfile.txt',
        types: [{
          description: 'Text Files',
          accept: {'text/plain': ['.txt']},
        }],
      });

      const writable = await handle.createWritable();
      await writable.write(fileContent);
      await writable.close();
      setFileName(handle.name);
      alert(`File saved as ${handle.name}`);
    } catch (err) {
      console.error('Error saving file:', err);
    }
  };

  // Function to open and read file
  const openFile = async () => {
    try {
      const [handle] = await window.showOpenFilePicker({
        types: [{
          description: 'Text Files',
          accept: {'text/plain': ['.txt']},
        }],
        multiple: false,
      });

      const file = await handle.getFile();
      const content = await file.text();
      setFileContent(content);
      setFileName(file.name);
    } catch (err) {
      console.error('Error opening file:', err);
    }
  };

  return (
    <div>
      <h1>File System Access API</h1>
      <button onClick={openFile}>Open File</button>
      <button onClick={saveFile}>Save File</button>
      <br /><br />
      <textarea
        rows="10"
        cols="50"
        value={fileContent}
        onChange={(e) => setFileContent(e.target.value)}
      />
      <br />
      {fileName && <p>Opened/Saved file: {fileName}</p>}
    </div>
  );
};

export default App;
